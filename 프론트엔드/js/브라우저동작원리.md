https://poiemaweb.com/js-browser 를 공부하고 정리한 문서입니다.

# 브라우저의 핵심 기능

브라우저의 핵심 기능은 사용자가 참조하고자 하는 웹페이지를 요청하고 응답을 받아 브라우저에 표시하는 것이다. 브라우저는 서버로부터 HTML CSS Javascript 이미지 파일 등을 응답 받는다.
HTML,CSS파일은 렌더링엔진의 HTML파서와 CSS파서에 의해 파싱 되어 DOM트리 CSSOM 트리로 변환되고 렌더트리로 결합된다. 렌더트리를 기반으로 브라우저는 웹 페이지를 표시한다.

## 자바스크립트의 처리 방법

---

자바스크립트는 렌더링 엔진이 아닌 자바스크립트 엔진이 처리한다. HTML 파서는 script 태그를 만나면 자바스크립트 코드를 실행하기 위해서 DOM 생성을 중지하고 자바스크립트 엔진으로 제어 권한을 넘긴다. 제어권한을 받은 자바스크립트 엔진은 자바스크립트 파일을 로드하여 실행한다. 자바스크립트의 실행이 완료되면 다시 HTML 파서로 제어 권한이 넘어가고 DOM 생성을 재개한다.

이것은 script태그의 위치에 따라 블로킹이 발생하여 DOM 생성이 지연될 수 있다는 것을 의마한다.

body 가장 아래에 script를 위치시키는 것이 가장 좋은 방법인 것 같다.

- HTML 요소들이 스크립트 로딩 지연으로 인해 렌더링에 지장 받는 일이 발생하지 않아 페이지 로딩 시간이 단축된다

- DOM이 완성되지 않은 상태에서 DOM을 조작하면 에러가 생긴다

## defer 키워드

---

```html
<script src="js파일!" defer></script>
<!--src가 없으면 무시된다!-->
```

### async와 defer

- async 속성이 명시된 경우 : 브라우저가 페이지를 파싱되는 동안에도 스크립트가 실행됨.

- async 속성은 명시되어 있지 않고 defer 속성만 명시된 경우 : 브라우저가 페이지의 파싱을 모두 끝내면 스크립트가 실행됨.

- async 속성과 defer 속성이 모두 명시되어 있지 않은 경우 : 브라우저가 페이지를 파싱하기 전에 스크립트를 가져와 바로 실행시킴.

defer 키워드를 사용하면 백그라운드에서 스크립트를 다운 받기 때문에 html 파싱이 멈추지 않는다고 한다. 지연 스크립트는 DOMContentLoaded 이벤트가 생기기 전에 실행된다고 한다.
