# error-boundary

리액트 문서에 따르면 error-boundary는 **하위 컴포넌트 트리의 어디에서든 자바스크립트의 에러를 기록하며 깨진 컴포넌트 대신 폴백(UI)를 보여주는 React 컴포넌트이다.**  
이는 try-catch문 처럼 error가 발생했을 때 프로그램이 죽는 대신 프로그램을 살릴 여지를 주는 좋은 개념이다. error-boundary(이하 에러경계)는 렌더링 도중 생명주기 메서드 및 그 아래에 있는 전체 트리에서 에러를 잡아낸다.

## Note
에러 경계는 다음과 같은 에러는 포착하지 않는다.
- 이벤트 핸들러
- 비동기코드
- 서버사이드 렌더링
- 자식이 아닌 에러 경계 자체의 에러

생명주기 메서드인 static getDerivedStateFromError() 와 componentDidCatch()중 하나라도 정의하면 클래스 컴포넌트 자체가 에러 경계가 된다. 에러가 발생한 뒤에 새로운 UI를 그리려면 static getDerivedStateFromError()를 단순히 에러 정보를 기록하가 위해서라면 componentDidCatch를 사용하면 된다.

```js
class ErrorBoundary extends React.Component {
    constructor(props) {
        super(props);
        this.state = { hasError: false };
    }

    static getDerivedStateFromError(error) {
        // 다음 렌더링에서 풀백 UI가 보이도록 상태를 업데이트 한다.
        return {hasError: true};
    }

    componentDidCatch(error, errorInfo){
        logError(error, errorInfo);
    }

    render() {
        if(this.state.hasError) {
            return <ErrorPage />
        }

        return this.props.children;
    }
}
```

에러 경계는 오직 클래스 컴포넌트로만 만들 수 있다. 실제 사용에서도 한 개의 에러 경계 컴포넌트를 만들어서 애플리케이션 전체에서 사용하면 된다.

## 주의점

React 16부터는 에러 경계에서 포착되지 않은 에러가 발생하면 React 컴포넌트 트리의 전체 마운트가 해제된다.!! (앱이 다 깨진다는 소리이다 에러처리가 많이 중요해짐)